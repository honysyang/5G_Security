"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[7508],{40998:function(e,l,a){a.r(l),a.d(l,{default:function(){return m}});var t=a(20641),s=a(72644);const o={key:0},r={key:0},d={key:0};function i(e,l,a,i,u,b){const p=(0,t.g2)("el-input"),n=(0,t.g2)("el-form-item"),c=(0,t.g2)("el-option"),m=(0,t.g2)("el-select"),f=(0,t.g2)("el-date-picker"),h=(0,t.g2)("el-button"),F=(0,t.g2)("el-form"),_=(0,t.g2)("el-header"),v=(0,t.g2)("el-tag"),g=(0,t.g2)("el-switch"),w=(0,t.g2)("el-table-column"),k=(0,t.g2)("scTable"),y=(0,t.g2)("el-main"),V=(0,t.g2)("detail-view"),P=(0,t.g2)("el-drawer"),x=(0,t.g2)("el-container");return(0,t.uX)(),(0,t.Wv)(x,null,{default:(0,t.k6)((()=>[(0,t.bF)(_,{style:{height:"auto"}},{default:(0,t.k6)((()=>[(0,t.bF)(F,{inline:!0,model:u.search,"label-width":"100"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{label:"目的IP"},{default:(0,t.k6)((()=>[(0,t.bF)(p,{modelValue:u.search.dst_ip,"onUpdate:modelValue":l[0]||(l[0]=e=>u.search.dst_ip=e),placeholder:"目的IP",clearable:"",style:{width:"200px"}},null,8,["modelValue"])])),_:1}),(0,t.bF)(n,{label:"源IP"},{default:(0,t.k6)((()=>[(0,t.bF)(p,{modelValue:u.search.src_ip,"onUpdate:modelValue":l[1]||(l[1]=e=>u.search.src_ip=e),placeholder:"源IP",clearable:"",style:{width:"200px"}},null,8,["modelValue"])])),_:1}),(0,t.bF)(n,{label:"攻击阶段"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{modelValue:u.search.alter_stage,"onUpdate:modelValue":l[2]||(l[2]=e=>u.search.alter_stage=e),placeholder:"攻击阶段",clearable:"",style:{width:"200px"}},{default:(0,t.k6)((()=>[(0,t.bF)(c,{label:"侦查阶段",value:"0"}),(0,t.bF)(c,{label:"入侵暴露面阶段",value:"1"}),(0,t.bF)(c,{label:"横向移动阶段",value:"2"}),(0,t.bF)(c,{label:"攻击核心网阶段",value:"3"})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(n,{label:"目的网元"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{modelValue:u.search.dst_nf,"onUpdate:modelValue":l[3]||(l[3]=e=>u.search.dst_nf=e),placeholder:"目的网元",clearable:"",style:{width:"200px"}},{default:(0,t.k6)((()=>[(0,t.bF)(c,{label:"AUSF",value:"ausf"}),(0,t.bF)(c,{label:"AMF",value:"amf"}),(0,t.bF)(c,{label:"AF",value:"af"}),(0,t.bF)(c,{label:"SMF",value:"smf"}),(0,t.bF)(c,{label:"UPF",value:"upf"}),(0,t.bF)(c,{label:"NSSF",value:"nssf"}),(0,t.bF)(c,{label:"NEF",value:"nef"}),(0,t.bF)(c,{label:"NRF",value:"nrf"}),(0,t.bF)(c,{label:"PCF",value:"pcf"}),(0,t.bF)(c,{label:"UDM",value:"udm"})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(n,{label:"源网元"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{modelValue:u.search.src_nf,"onUpdate:modelValue":l[4]||(l[4]=e=>u.search.src_nf=e),placeholder:"目的网元",clearable:"",style:{width:"200px"}},{default:(0,t.k6)((()=>[(0,t.bF)(c,{label:"AUSF",value:"ausf"}),(0,t.bF)(c,{label:"AMF",value:"amf"}),(0,t.bF)(c,{label:"AF",value:"af"}),(0,t.bF)(c,{label:"SMF",value:"smf"}),(0,t.bF)(c,{label:"UPF",value:"upf"}),(0,t.bF)(c,{label:"NSSF",value:"nssf"}),(0,t.bF)(c,{label:"NEF",value:"nef"}),(0,t.bF)(c,{label:"NRF",value:"nrf"}),(0,t.bF)(c,{label:"PCF",value:"pcf"}),(0,t.bF)(c,{label:"UDM",value:"udm"})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(n,{label:"告警动作"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{modelValue:u.search.action,"onUpdate:modelValue":l[5]||(l[5]=e=>u.search.action=e),placeholder:"告警动作",clearable:"",style:{width:"200px"}},{default:(0,t.k6)((()=>[(0,t.bF)(c,{label:"通过",value:"0"}),(0,t.bF)(c,{label:"告警",value:"1"}),(0,t.bF)(c,{label:"阻断",value:"2"})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(n,{label:"危险等级"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{modelValue:u.search.danger_level,"onUpdate:modelValue":l[6]||(l[6]=e=>u.search.danger_level=e),placeholder:"危险等级",clearable:"",style:{width:"200px"}},{default:(0,t.k6)((()=>[(0,t.bF)(c,{label:"无等级",value:"-1"}),(0,t.bF)(c,{label:"低",value:"1"}),(0,t.bF)(c,{label:"中",value:"2"}),(0,t.bF)(c,{label:"高",value:"3"})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(n,{label:"5G协议类型"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{modelValue:u.search.protocol_5g,"onUpdate:modelValue":l[7]||(l[7]=e=>u.search.protocol_5g=e),placeholder:"5G协议类型",clearable:"",style:{width:"200px"}},{default:(0,t.k6)((()=>[(0,t.bF)(c,{label:"PFCP",value:"PFCP"}),(0,t.bF)(c,{label:"GTP-U",value:"GTP-U"}),(0,t.bF)(c,{label:"GTP-C",value:"GTP-C"}),(0,t.bF)(c,{label:"SCTP",value:"SCTP"}),(0,t.bF)(c,{label:"NGAP",value:"NGAP"}),(0,t.bF)(c,{label:"HTTP2",value:"HTTP2"})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(n,{label:"接口类型"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{modelValue:u.search.interface,"onUpdate:modelValue":l[8]||(l[8]=e=>u.search.interface=e),placeholder:"接口类型",clearable:"",style:{width:"200px"}},{default:(0,t.k6)((()=>[(0,t.bF)(c,{label:"N1",value:"n1"}),(0,t.bF)(c,{label:"N2",value:"n2"}),(0,t.bF)(c,{label:"N3",value:"n3"}),(0,t.bF)(c,{label:"N4",value:"n4"})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(n,{label:"发生时间"},{default:(0,t.k6)((()=>[(0,t.bF)(f,{modelValue:u.search.time,"onUpdate:modelValue":l[9]||(l[9]=e=>u.search.time=e),type:"daterange","start-placeholder":"区间开始","end-placeholder":"区间结束",clearable:"",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),(0,t.bF)(n,null,{default:(0,t.k6)((()=>[(0,t.bF)(h,{type:"primary",icon:"el-icon-search",onClick:b.upsearch},null,8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1}),(0,t.bF)(y,{class:"nopadding"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{ref:"table",apiObj:u.list.apiObj,column:u.list.column,params:u.params,"row-key":"id",stripe:""},{alter_stage:(0,t.k6)((e=>[e.row.alter_stage?((0,t.uX)(),(0,t.Wv)(v,{key:1,effect:"dark",type:u.tagAlterList["alert"+e.row.alter_stage].type},{default:(0,t.k6)((()=>[(0,t.eW)((0,s.v_)(u.tagAlterList["alert"+e.row.alter_stage].text),1)])),_:2},1032,["type"])):((0,t.uX)(),(0,t.CE)("span",o,"--"))])),danger_level:(0,t.k6)((e=>[-1==e.row.danger_level?((0,t.uX)(),(0,t.CE)("span",r,"--")):((0,t.uX)(),(0,t.Wv)(v,{key:1,effect:"light",type:u.dangerList[e.row.danger_level].type},{default:(0,t.k6)((()=>[(0,t.eW)((0,s.v_)(u.dangerList[e.row.danger_level].text),1)])),_:2},1032,["type"]))])),dispose_status:(0,t.k6)((e=>[e.row.dispose_status?((0,t.uX)(),(0,t.Wv)(g,{key:1,modelValue:e.row.dispose_status,"onUpdate:modelValue":l=>e.row.dispose_status=l,"inline-prompt":"","active-icon":u.disposeIconList.on,"inactive-icon":u.disposeIconList.off,"active-value":"1","inactive-value":"0",loading:e.row.disposeLoadding,"before-change":()=>b.beforeChangeDisposeStatus(e.row)},null,8,["modelValue","onUpdate:modelValue","active-icon","inactive-icon","loading","before-change"])):((0,t.uX)(),(0,t.CE)("span",d,"--"))])),action:(0,t.k6)((e=>[(0,t.bF)(v,{effect:"plain",type:u.actionList[e.row.action].type},{default:(0,t.k6)((()=>[(0,t.eW)((0,s.v_)(u.actionList[e.row.action].text),1)])),_:2},1032,["type"])])),stamptime:(0,t.k6)((e=>[(0,t.eW)((0,s.v_)(b.showTime(e.row.stamptime)),1)])),default:(0,t.k6)((()=>[(0,t.bF)(w,{label:"操作",fixed:"right",align:"left",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(h,{type:"primary",plain:"",size:"small",onClick:l=>b.table_view(e.row)},{default:(0,t.k6)((()=>[(0,t.eW)("查看")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["apiObj","column","params"])])),_:1}),(0,t.bF)(P,{modelValue:u.drawer,"onUpdate:modelValue":l[10]||(l[10]=e=>u.drawer=e),title:"详情",size:"80%"},{default:(0,t.k6)((()=>[(0,t.bF)(V,{params:u.drawerParams},null,8,["params"])])),_:1},8,["modelValue"])])),_:1})}var u=a(48548),b=a(61520),p={name:"flowDataIndex",components:{Check:u.Check,Close:u.Close,DetailView:b["default"]},data(){return{search:{},dialog:{save:!1,info:!1},list:{apiObj:this.$API.flow.flowSignal.page,column:[{label:"目的IP",prop:"dst_ip",width:"150"},{label:"源IP",prop:"src_ip",width:"150"},{label:"目的端口",prop:"dst_port",width:"100"},{label:"源端口",prop:"src_port",width:"100"},{label:"攻击阶段",prop:"alter_stage",width:"150"},{label:"目的网元",prop:"dst_nf",width:"100"},{label:"源网元",prop:"src_nf",width:"100"},{label:"告警动作",prop:"action",width:"100"},{label:"危险等级",prop:"danger_level",width:"100"},{label:"异常结果",prop:"result_exception",width:"100",hide:!0},{label:"5G协议类型",prop:"protocol_5g",width:"120"},{label:"UE-IP",prop:"user_ip",width:"150"},{label:"发生时间",prop:"stamptime",width:"200"}]},selection:[],params:{src_ip:"",src_port:"",dst_ip:"",dst_port:"",time:[]},tagAlterList:{alert0:{text:"侦查阶段",type:"info"},alert1:{text:"入侵暴露面阶段",type:"success"},alert2:{text:"横向移动阶段",type:"primary"},alert3:{text:"攻击核心网阶段",type:"danger"}},dangerList:{0:{text:"正常",type:"info"},1:{text:"低",type:"success"},2:{text:"中",type:"primary"},3:{text:"高",type:"danger"}},actionList:{0:{text:"通过",type:"success"},1:{text:"告警",type:"danger"},2:{text:"阻断",type:"info"}},disposeIconList:{on:u.Check,off:u.Close},drawer:!1,drawerParams:{}}},computed:{showTime(){return e=>this.$moment(e).utc().format("YYYY-MM-DD HH:mm:ss")}},mounted(){},methods:{async beforeChangeDisposeStatus(e){e.disposeLoadding=!0;let l={id:e.id,dispose_status:"0"==e.dispose_status?"1":"0"},a=await this.$API.flow.flowSignal.disposeStatus.post(l);return 200==a.code?(e.disposeLoadding=!1,this.$message.success("处置成功!"),!0):(e.disposeLoadding=!1,this.$message.error("处置失败!"),!1)},upsearch(){null==this.search.time&&(this.search.time=[]),this.$refs.table.upData(this.search)},table_view(e){this.drawerParams={id:Number(e.id),globel_id:e.globel_id},this.drawer=!0}}},n=a(66262);const c=(0,n.A)(p,[["render",i]]);var m=c}}]);