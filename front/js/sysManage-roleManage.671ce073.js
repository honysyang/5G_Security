"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[8765],{11912:function(e,a,t){t.r(a),t.d(a,{default:function(){return m}});var l=t(20641),i=t(72644);const s={class:"base-content"},n={class:"left-panel"},o={class:"right-panel"},r={class:"right-panel-search"},d={class:"base-pagination"};function u(e,a,t,u,c,h){const g=(0,l.g2)("el-button"),p=(0,l.g2)("el-input"),b=(0,l.g2)("el-header"),m=(0,l.g2)("el-table-column"),k=(0,l.g2)("el-switch"),f=(0,l.g2)("el-popconfirm"),w=(0,l.g2)("el-table"),v=(0,l.g2)("el-pagination"),C=(0,l.g2)("el-main"),_=(0,l.g2)("el-container"),S=(0,l.g2)("save-dialog"),y=(0,l.g2)("permission-dialog"),$=(0,l.gN)("loading");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",s,[(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.bF)(b,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",n,[(0,l.bF)(g,{type:"primary",icon:"el-icon-plus",onClick:h.add},null,8,["onClick"])]),(0,l.Lk)("div",o,[(0,l.Lk)("div",r,[(0,l.bF)(p,{modelValue:c.search.keyword,"onUpdate:modelValue":a[0]||(a[0]=e=>c.search.keyword=e),style:{width:"240px"},placeholder:"角色名称"},null,8,["modelValue"]),(0,l.bF)(g,{icon:"el-icon-search",onClick:h.initTable},null,8,["onClick"])])])])),_:1}),(0,l.bF)(C,{class:"nopadding"},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(w,{style:{width:"100%"},stripe:"",fit:"",size:"large",height:"500","header-row-class-name":"table-header-style",data:c.tableData,"row-key":"role_id"},{default:(0,l.k6)((()=>[(0,l.bF)(m,{prop:"name",label:"名称",width:"150","show-overflow-tooltip":""}),(0,l.bF)(m,{prop:"alias",label:"别名",width:"150","show-overflow-tooltip":""}),(0,l.bF)(m,{prop:"status",label:"状态",width:"100"},{default:(0,l.k6)((e=>[(0,l.bF)(k,{modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,loading:e.row.$switch_status,"active-value":1,"inactive-value":0,"before-change":()=>h.beforeChangeDisposeStatus(e.row)},null,8,["modelValue","onUpdate:modelValue","loading","before-change"])])),_:1}),(0,l.bF)(m,{prop:"remark",label:"备注","show-overflow-tooltip":""}),(0,l.bF)(m,{prop:"created_at",label:"创建时间",width:"180"},{default:(0,l.k6)((e=>[(0,l.eW)((0,i.v_)(h.showTime(e.row.created_at)),1)])),_:1}),(0,l.bF)(m,{fixed:"right",label:"操作",width:"200"},{default:(0,l.k6)((e=>[(0,l.bF)(g,{link:"",size:"small",color:"#279C89",plain:"",onClick:a=>h.permission(e.row)},{default:(0,l.k6)((()=>[(0,l.eW)("权限设置")])),_:2},1032,["onClick"]),(0,l.bF)(g,{link:"",size:"small",type:"primary",plain:"",onClick:a=>h.table_edit(e.row,e.$index)},{default:(0,l.k6)((()=>[(0,l.eW)("编辑")])),_:2},1032,["onClick"]),(0,l.bF)(f,{title:"确定删除吗？",onConfirm:a=>h.table_del(e.row,e.$index)},{reference:(0,l.k6)((()=>[(0,l.bF)(g,{link:"",size:"small",type:"danger",plain:""},{default:(0,l.k6)((()=>[(0,l.eW)("删除")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[$,c.tableLoading]]),(0,l.Lk)("div",d,[(0,l.bF)(v,{"current-page":c.pageIndex,"onUpdate:currentPage":a[1]||(a[1]=e=>c.pageIndex=e),"page-size":c.pageSize,"onUpdate:pageSize":a[2]||(a[2]=e=>c.pageSize=e),"page-sizes":[10,20,50],small:e.small,disabled:e.disabled,background:e.background,layout:"total, sizes, prev, pager, next, jumper",total:c.total,onSizeChange:h.handleSizeChange,onCurrentChange:h.handleCurrentChange},null,8,["current-page","page-size","small","disabled","background","total","onSizeChange","onCurrentChange"])])])),_:1})])),_:1})])),_:1})]),c.dialog.save?((0,l.uX)(),(0,l.Wv)(S,{key:0,ref:"saveDialog",onSuccess:h.handleSaveSuccess,onClosed:a[3]||(a[3]=e=>c.dialog.save=!1)},null,8,["onSuccess"])):(0,l.Q3)("",!0),c.dialog.permission?((0,l.uX)(),(0,l.Wv)(y,{key:1,ref:"permissionDialog",onClosed:a[4]||(a[4]=e=>c.dialog.permission=!1),onSuccess:h.handleSaveMenuSuccess},null,8,["onSuccess"])):(0,l.Q3)("",!0)],64)}var c=t(45304),h=t(7333),g={name:"role",components:{saveDialog:c["default"],permissionDialog:h["default"]},data(){return{tableData:[],pageIndex:1,pageSize:10,total:400,tableLoading:!1,tableSelections:[],search:{},dialog:{save:!1,permission:!1}}},computed:{showTime(){return e=>this.$moment(e).utc().format("YYYY-MM-DD HH:mm:ss")}},created(){this.initTable()},methods:{async initTable(){let e={size:this.pageSize,page:this.pageIndex,keyword:this.search.keyword},a=await this.$API.sysManage.role.list.post(e);200==a.code&&(this.tableData=a.data.list,this.total=a.data.total)},handleSizeChange(e){this.pageSize=e,this.pageIndex=1,this.initTable()},handleCurrentChange(e){this.pageIndex=e,this.initTable()},add(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open()}))},handleSaveSuccess(e,a){("add"==a||"edit"==a)&&this.initTable()},async table_del(e){var a={role_id:e.role_id},t=await this.$API.sysManage.role.del.delete(a);200==t.code?(this.initTable(),this.$message.success("删除成功")):this.$alert(t.message,"提示",{type:"error"})},table_edit(e){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open("edit").setData(e)}))},async beforeChangeDisposeStatus(e){e.$switch_status=!0;let a={role_id:e.role_id,status:1==e.status?0:1},t=await this.$API.sysManage.role.upStatus.put(a);return 200==t.code?(e.$switch_status=!1,this.$message.success("处置成功!"),!0):(e.$switch_status=!1,this.$message.error("处置失败!"),!1)},permission(e){this.dialog.permission=!0,this.$nextTick((()=>{this.$refs.permissionDialog.open(e)}))},handleSaveMenuSuccess(){this.initTable()},filterTree(e){var a=null;function t(l){l.forEach((l=>{l.id==e&&(a=l),l.children&&t(l.children)}))}return t(this.$refs.table.tableData),a}}},p=t(66262);const b=(0,p.A)(g,[["render",u]]);var m=b}}]);