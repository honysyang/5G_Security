"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[9543],{11615:function(e,t,a){a.r(t),a.d(t,{default:function(){return V}});var l=a(20641),s=a(72644);const r=e=>((0,l.Qi)("data-v-c398f6b2"),e=e(),(0,l.jt)(),e),i={class:"nblock"},o={class:"nblock-src"},n={class:"nblock-title"},d={class:"nblock-cen"},p=r((()=>(0,l.Lk)("label",null,"告警数量",-1))),c=r((()=>(0,l.Lk)("label",null,"已处置",-1))),u=r((()=>(0,l.Lk)("label",null,"威胁等级",-1))),_=r((()=>(0,l.Lk)("label",null,"覆盖协议",-1))),f={class:"nblock-dst"},b={class:"nblock-title"},w=r((()=>(0,l.Lk)("div",{class:"left-panel"},null,-1))),g={class:"right-panel"},k={class:"right-panel-search"},h={key:0},m={key:0},v={key:0};function y(e,t,a,r,y,I){const F=(0,l.g2)("el-tag"),L=(0,l.g2)("DArrowRight"),C=(0,l.g2)("el-icon"),D=(0,l.g2)("el-option"),W=(0,l.g2)("el-select"),x=(0,l.g2)("el-button"),V=(0,l.g2)("el-header"),X=(0,l.g2)("el-switch"),P=(0,l.g2)("el-table-column"),z=(0,l.g2)("scTable"),A=(0,l.g2)("el-main"),E=(0,l.g2)("detail-view"),S=(0,l.g2)("el-drawer"),$=(0,l.g2)("el-container");return(0,l.uX)(),(0,l.Wv)($,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",i,[(0,l.Lk)("div",o,[(0,l.Lk)("div",n,(0,s.v_)(y.drawDes.Src_NF),1),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(y.drawInfoSrc,(e=>((0,l.uX)(),(0,l.CE)("p",{key:e.id},[(0,l.bF)(F,{type:"success",size:"small"},{default:(0,l.k6)((()=>[(0,l.eW)("IP:"+(0,s.v_)(e.ip),1)])),_:2},1024),(0,l.bF)(F,{type:"info",size:"small"},{default:(0,l.k6)((()=>[(0,l.eW)("端口:"+(0,s.v_)(e.ports),1)])),_:2},1024)])))),128))]),(0,l.Lk)("div",d,[(0,l.bF)(C,{color:"#F16C6D"},{default:(0,l.k6)((()=>[(0,l.bF)(L)])),_:1}),(0,l.Lk)("div",null,[(0,l.Lk)("p",null,[p,(0,l.Lk)("span",null,(0,s.v_)(y.drawInfoInter.alter_stage_3_count),1),c,(0,l.Lk)("span",null,(0,s.v_)(y.drawInfoInter.dispose_status_0_count),1)]),(0,l.Lk)("p",null,[u,(0,l.bF)(F,{type:"danger",size:"small"},{default:(0,l.k6)((()=>[(0,l.eW)("高"+(0,s.v_)(y.drawInfoInter.danger_level_3_count),1)])),_:1}),(0,l.bF)(F,{type:"warning",size:"small"},{default:(0,l.k6)((()=>[(0,l.eW)("中"+(0,s.v_)(y.drawInfoInter.danger_level_2_count),1)])),_:1}),(0,l.bF)(F,{type:"info",size:"small"},{default:(0,l.k6)((()=>[(0,l.eW)("低"+(0,s.v_)(y.drawInfoInter.danger_level_1_count),1)])),_:1})]),(0,l.Lk)("p",null,[_,((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(y.drawInfoInter.protocol_5g_set,((e,t)=>((0,l.uX)(),(0,l.Wv)(F,{type:"success",size:"small",key:t},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e),1)])),_:2},1024)))),128))])]),(0,l.bF)(C,{color:"#409EFF"},{default:(0,l.k6)((()=>[(0,l.bF)(L)])),_:1})]),(0,l.Lk)("div",f,[(0,l.Lk)("div",b,(0,s.v_)(y.drawDes.Dst_NF),1),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(y.drawInfoDst,(e=>((0,l.uX)(),(0,l.CE)("p",{key:e.id},[(0,l.bF)(F,{type:"warning",size:"small"},{default:(0,l.k6)((()=>[(0,l.eW)("IP:"+(0,s.v_)(e.ip),1)])),_:2},1024),(0,l.bF)(F,{type:"info",size:"small"},{default:(0,l.k6)((()=>[(0,l.eW)("端口:"+(0,s.v_)(e.ports),1)])),_:2},1024)])))),128))])]),(0,l.bF)(V,null,{default:(0,l.k6)((()=>[w,(0,l.Lk)("div",g,[(0,l.Lk)("div",k,[(0,l.bF)(W,{modelValue:y.search.danger_level,"onUpdate:modelValue":t[0]||(t[0]=e=>y.search.danger_level=e),placeholder:"危险等级",clearable:"",style:{width:"200px"}},{default:(0,l.k6)((()=>[(0,l.bF)(D,{label:"低",value:"1"}),(0,l.bF)(D,{label:"中",value:"2"}),(0,l.bF)(D,{label:"高",value:"3"})])),_:1},8,["modelValue"]),(0,l.bF)(W,{modelValue:y.search.dispose_status,"onUpdate:modelValue":t[1]||(t[1]=e=>y.search.dispose_status=e),placeholder:"处置状态",clearable:"",style:{width:"200px"}},{default:(0,l.k6)((()=>[(0,l.bF)(D,{label:"未处置",value:"0"}),(0,l.bF)(D,{label:"已处置",value:"1"})])),_:1},8,["modelValue"]),(0,l.bF)(x,{type:"primary",icon:"el-icon-search",onClick:I.upsearch},null,8,["onClick"])])])])),_:1}),(0,l.bF)(A,{class:"nopadding"},{default:(0,l.k6)((()=>[(0,l.bF)(z,{ref:"table",apiObj:y.list.apiObj,column:y.list.column,"row-key":"id",stripe:"",params:y.params},{danger_level:(0,l.k6)((e=>[-1==e.row.danger_level?((0,l.uX)(),(0,l.CE)("span",h,"--")):((0,l.uX)(),(0,l.Wv)(F,{key:1,effect:"light",type:y.dangerList[e.row.danger_level].type},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(y.dangerList[e.row.danger_level].text),1)])),_:2},1032,["type"]))])),alter_stage:(0,l.k6)((e=>[e.row.alter_stage?((0,l.uX)(),(0,l.Wv)(F,{key:1,effect:"dark",type:y.tagAlterList["alert"+e.row.alter_stage].type},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(y.tagAlterList["alert"+e.row.alter_stage].text),1)])),_:2},1032,["type"])):((0,l.uX)(),(0,l.CE)("span",m,"--"))])),stamptime:(0,l.k6)((e=>[(0,l.eW)((0,s.v_)(I.showTime(e.row.stamptime)),1)])),dispose_status:(0,l.k6)((e=>[e.row.dispose_status?((0,l.uX)(),(0,l.Wv)(X,{key:1,modelValue:e.row.dispose_status,"onUpdate:modelValue":t=>e.row.dispose_status=t,"inline-prompt":"","active-icon":y.disposeIconList.on,"inactive-icon":y.disposeIconList.off,"active-value":"1","inactive-value":"0",loading:e.row.disposeLoadding,"before-change":()=>I.beforeChangeDisposeStatus(e.row)},null,8,["modelValue","onUpdate:modelValue","active-icon","inactive-icon","loading","before-change"])):((0,l.uX)(),(0,l.CE)("span",v,"--"))])),default:(0,l.k6)((()=>[(0,l.bF)(P,{label:"操作",fixed:"right",align:"center",width:"100"},{default:(0,l.k6)((e=>[(0,l.bF)(x,{text:"",type:"primary",size:"small",onClick:t=>I.table_view(e.row)},{default:(0,l.k6)((()=>[(0,l.eW)("查看")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["apiObj","column","params"])])),_:1}),(0,l.bF)(S,{modelValue:y.drawer,"onUpdate:modelValue":t[2]||(t[2]=e=>y.drawer=e),title:"详情",size:"80%"},{default:(0,l.k6)((()=>[(0,l.bF)(E,{params:y.drawerParams},null,8,["params"])])),_:1},8,["modelValue"])])),_:1})}var I=a(48548),F=a(63319),L=a(2543),C=a.n(L),D={name:"ngap",components:{Check:I.Check,Close:I.Close,DArrowRight:I.DArrowRight,DetailView:F["default"]},data(){return{list:{apiObj:this.$API.warn.n1.page,column:[{label:"目的IP",prop:"dst_ip",width:"150"},{label:"目的端口",prop:"dst_port",width:"150"},{label:"目的网元",prop:"dst_nf",width:"150"},{label:"源IP",prop:"src_ip",width:"150"},{label:"源端口",prop:"src_port",width:"100"},{label:"源网元",prop:"src_nf",width:"150"},{label:"攻击阶段",prop:"alter_stage",width:"150"},{label:"事件时间",prop:"stamptime",width:"200"},{label:"危险等级",prop:"danger_level",width:"150"},{label:"处置状态",prop:"dispose_status",width:"100"},{label:"协议类型",prop:"protocol",width:"150"}]},params:{interface_type:"n1"},dangerList:{0:{text:"正常",type:"info"},1:{text:"低",type:"success"},2:{text:"中",type:"primary"},3:{text:"高",type:"danger"}},tagAlterList:{alert0:{text:"侦查阶段",type:"info"},alert1:{text:"入侵暴露面阶段",type:"success"},alert2:{text:"横向移动阶段",type:"primary"},alert3:{text:"攻击核心网阶段",type:"danger"}},disposeIconList:{on:I.Check,off:I.Close},search:{danger_level:"",dispose_status:""},matchText:{pfcp_pdr:"恶意篡改PDR规则",pfcp_fdr:"恶意篡改FDR规则",pfcp_delete_session:"恶意构造删除请求",pfcp_n4_smf:"恶意伪造N4接口指令",pfcp_form:"非法格式报文攻击"},drawer:!1,drawerParams:{},drawInfoSrc:{},drawInfoDst:{},drawInfoInter:{},drawDes:{}}},computed:{showTime(){return e=>this.$moment(e).utc().format("YYYY-MM-DD HH:mm:ss")}},created(){this.initDraw()},methods:{async initDraw(){let e={interface:"n1"},t=await this.$API.warn.n1.draw.post(e);this.drawInfoSrc=t.Src_NF,this.drawInfoDst=t.Dst_NF,this.drawInfoInter=t.Interface_Info[0],this.drawDes=t.description},upsearch(){this.$refs.table.upData(this.search)},async beforeChangeDisposeStatus(e){e.disposeLoadding=!0;let t={id:e.id,globel_id:e.globel_id,dispose_status:"0"==e.dispose_status?"1":"0"},a=await this.$API.system.statusChange.put(t);return 200==a.status?(e.disposeLoadding=!1,this.$message.success("处置成功!"),!0):(e.disposeLoadding=!1,this.$message.error("处置失败!"),!1)},table_view(e){this.drawerParams={id:e.id,globel_id:e.globel_id,protocol:C().toUpper(e.protocol)},this.drawer=!0}}},W=a(66262);const x=(0,W.A)(D,[["render",y],["__scopeId","data-v-c398f6b2"]]);var V=x}}]);