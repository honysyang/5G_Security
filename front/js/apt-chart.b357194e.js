"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[6531],{78599:function(t,e,a){a.r(e),a.d(e,{default:function(){return h}});var i=a(20641),l=a(72644);const o={class:"title"},s={class:"time"},n={class:"ctable"};function r(t,e,a,r,d,p){const u=(0,i.g2)("el-date-picker"),c=(0,i.g2)("el-button"),h=(0,i.g2)("el-table-column"),m=(0,i.g2)("el-table"),b=(0,i.g2)("scEcharts"),g=(0,i.g2)("el-card"),_=(0,i.g2)("el-col"),v=(0,i.g2)("el-row"),x=(0,i.g2)("el-main");return(0,i.uX)(),(0,i.Wv)(x,null,{default:(0,i.k6)((()=>[(0,i.Lk)("div",o,[(0,i.Lk)("span",null,"告警流量总数："+(0,l.v_)(d.info.total_count),1),(0,i.Lk)("div",s,[(0,i.bF)(u,{modelValue:d.searchTime,"onUpdate:modelValue":e[0]||(e[0]=t=>d.searchTime=t),type:"daterange","unlink-panels":"","range-separator":"至","start-placeholder":"起始时间","end-placeholder":"结束时间",shortcuts:d.shortcuts,size:"small",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue","shortcuts"])]),(0,i.bF)(c,{icon:"el-icon-search",size:"small",type:"primary",onClick:p.initData},null,8,["onClick"]),(0,i.bF)(c,{icon:"sc-icon-download",size:"small",type:"primary",onClick:p.download},{default:(0,i.k6)((()=>[(0,i.eW)("下载报表")])),_:1},8,["onClick"])]),(0,i.Lk)("div",n,[(0,i.bF)(m,{data:d.tableData,style:{width:"100%"}},{default:(0,i.k6)((()=>[(0,i.bF)(h,{prop:"alertTotal",label:"告警数量",width:"180"}),(0,i.bF)(h,{prop:"count",label:"流量总数",width:"180"}),(0,i.bF)(h,{prop:"name",label:"系统名称"}),(0,i.bF)(h,{prop:"user",label:"用户"}),(0,i.bF)(h,{prop:"ts",label:"起始时间"}),(0,i.bF)(h,{prop:"te",label:"结束时间"})])),_:1},8,["data"])]),(0,i.bF)(v,{gutter:15},{default:(0,i.k6)((()=>[(0,i.bF)(_,{lg:24},{default:(0,i.k6)((()=>[(0,i.bF)(g,{shadow:"never"},{default:(0,i.k6)((()=>[(0,i.bF)(b,{height:"300px",option:d.option1},null,8,["option"])])),_:1})])),_:1}),(0,i.bF)(_,{lg:16},{default:(0,i.k6)((()=>[(0,i.bF)(g,{shadow:"never"},{default:(0,i.k6)((()=>[(0,i.bF)(b,{height:"300px",option:d.option4},null,8,["option"])])),_:1})])),_:1}),(0,i.bF)(_,{lg:8},{default:(0,i.k6)((()=>[(0,i.bF)(g,{shadow:"never"},{default:(0,i.k6)((()=>[(0,i.bF)(b,{height:"300px",option:d.option3},null,8,["option"])])),_:1})])),_:1})])),_:1})])),_:1})}a(28743);var d=a(33240),p={name:"chart",components:{scEcharts:d.A},data(){return{searchTime:[],shortcuts:[{text:"近7天",value:()=>{const t=new Date,e=new Date;return e.setTime(e.getTime()-6048e5),[e,t]}},{text:"近30天",value:()=>{const t=new Date,e=new Date;return e.setTime(e.getTime()-2592e6),[e,t]}},{text:"近90天",value:()=>{const t=new Date,e=new Date;return e.setTime(e.getTime()-7776e6),[e,t]}}],option1:{title:{text:"告警IP TOP5"},grid:{top:"80px"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[{data:[],type:"bar",barWidth:"15px"}]},option4:{title:{text:"告警类别 TOP5"},grid:{top:"80px"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[{data:[],type:"bar",barWidth:"15px"}]},option3:{title:{text:"处置概览"},tooltip:{trigger:"item"},series:[{name:"数据解释",type:"pie",radius:["40%","70%"],center:["50%","60%"],label:!1,data:[{value:1048,name:"搜索引擎"},{value:735,name:"直接访问"},{value:580,name:"邮件营销"},{value:484,name:"联盟广告"},{value:300,name:"视频广告"}]}]},info:{},tableData:[]}},created(){this.initData()},methods:{async initData(){var t=this.$TOOL.data.get("USER_INFO");let e={user_id:t.user_id,time:this.searchTime},a=await this.$API.apt.chart.detail.post(e);this.info=a.data;let i=[],l=[];a.data.top_ips.forEach((t=>{i.push(t.Src_ip),l.push(t.Alert_count)})),this.option1.xAxis.data=i,this.option1.series[0].data=l;let o=[],s=[];a.data.top_sids.forEach((t=>{o.push(t.name),s.push(t.sid_count)})),this.option4.xAxis.data=o,this.option4.series[0].data=s;let n=[{value:a.data.total_dispose,name:"已处置"},{value:a.data.total_un_dispose,name:"未处置"}];this.option3.series[0].data=n;let r={alertTotal:a.data1.total_count,count:a.data1.total_count_total,name:a.data1.systemname,user:a.data1.username,ts:this.searchTime[0]||"--",te:this.searchTime[1]||"--"};this.tableData=[r]},async download(){var t=this.$TOOL.data.get("USER_INFO");let e=`${this.$API.apt.chart.down.url}?user_id=${t.user_id};time=${this.searchTime}`;window.open(e)}}},u=a(66262);const c=(0,u.A)(p,[["render",r],["__scopeId","data-v-31d75def"]]);var h=c}}]);