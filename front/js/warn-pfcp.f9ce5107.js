"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[8575],{39593:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var l=a(20641),s=a(72644);const i=(0,l.Lk)("div",{class:"left-panel"},null,-1),r={class:"right-panel"},o={class:"right-panel-search"},p={key:0},d={key:0},n={key:0};function u(e,t,a,u,c,g){const b=(0,l.g2)("scEcharts"),_=(0,l.g2)("el-card"),h=(0,l.g2)("el-col"),m=(0,l.g2)("el-row"),f=(0,l.g2)("el-main"),v=(0,l.g2)("el-option"),w=(0,l.g2)("el-select"),k=(0,l.g2)("el-button"),y=(0,l.g2)("el-header"),F=(0,l.g2)("el-tag"),x=(0,l.g2)("el-switch"),C=(0,l.g2)("el-table-column"),V=(0,l.g2)("scTable"),L=(0,l.g2)("detail-view"),A=(0,l.g2)("el-drawer"),D=(0,l.g2)("el-container");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(f,null,{default:(0,l.k6)((()=>[(0,l.bF)(m,{gutter:15},{default:(0,l.k6)((()=>[(0,l.bF)(h,{lg:24},{default:(0,l.k6)((()=>[(0,l.bF)(_,{shadow:"never"},{default:(0,l.k6)((()=>[(0,l.bF)(b,{height:"300px",option:c.option2},null,8,["option"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.bF)(D,null,{default:(0,l.k6)((()=>[(0,l.bF)(y,null,{default:(0,l.k6)((()=>[i,(0,l.Lk)("div",r,[(0,l.Lk)("div",o,[(0,l.bF)(w,{modelValue:c.search.alter_stage,"onUpdate:modelValue":t[0]||(t[0]=e=>c.search.alter_stage=e),placeholder:"攻击阶段",clearable:"",style:{width:"200px"}},{default:(0,l.k6)((()=>[(0,l.bF)(v,{label:"侦查阶段",value:"0"}),(0,l.bF)(v,{label:"入侵暴露面阶段",value:"1"}),(0,l.bF)(v,{label:"横向移动阶段",value:"2"}),(0,l.bF)(v,{label:"攻击核心网阶段",value:"3"})])),_:1},8,["modelValue"]),(0,l.bF)(w,{modelValue:c.search.danger_level,"onUpdate:modelValue":t[1]||(t[1]=e=>c.search.danger_level=e),placeholder:"危险等级",clearable:"",style:{width:"200px"}},{default:(0,l.k6)((()=>[(0,l.bF)(v,{label:"低",value:"1"}),(0,l.bF)(v,{label:"中",value:"2"}),(0,l.bF)(v,{label:"高",value:"3"})])),_:1},8,["modelValue"]),(0,l.bF)(w,{modelValue:c.search.dispose_status,"onUpdate:modelValue":t[2]||(t[2]=e=>c.search.dispose_status=e),placeholder:"处置状态",clearable:"",style:{width:"200px"}},{default:(0,l.k6)((()=>[(0,l.bF)(v,{label:"未处置",value:"0"}),(0,l.bF)(v,{label:"已处置",value:"1"})])),_:1},8,["modelValue"]),(0,l.bF)(k,{type:"primary",icon:"el-icon-search",onClick:g.upsearch},null,8,["onClick"])])])])),_:1}),(0,l.bF)(f,{class:"nopadding"},{default:(0,l.k6)((()=>[(0,l.bF)(V,{ref:"table",apiObj:c.list.apiObj,column:c.list.column,"row-key":"id",stripe:""},{danger_level:(0,l.k6)((e=>[-1==e.row.danger_level?((0,l.uX)(),(0,l.CE)("span",p,"--")):((0,l.uX)(),(0,l.Wv)(F,{key:1,effect:"light",type:c.dangerList[e.row.danger_level].type},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(c.dangerList[e.row.danger_level].text),1)])),_:2},1032,["type"]))])),alter_stage:(0,l.k6)((e=>[e.row.alter_stage?((0,l.uX)(),(0,l.Wv)(F,{key:1,effect:"dark",type:c.tagAlterList["alert"+e.row.alter_stage].type},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(c.tagAlterList["alert"+e.row.alter_stage].text),1)])),_:2},1032,["type"])):((0,l.uX)(),(0,l.CE)("span",d,"--"))])),stamptime:(0,l.k6)((e=>[(0,l.eW)((0,s.v_)(g.showTime(e.row.stamptime)),1)])),dispose_status:(0,l.k6)((e=>[e.row.dispose_status?((0,l.uX)(),(0,l.Wv)(x,{key:1,modelValue:e.row.dispose_status,"onUpdate:modelValue":t=>e.row.dispose_status=t,"inline-prompt":"","active-icon":c.disposeIconList.on,"inactive-icon":c.disposeIconList.off,"active-value":"1","inactive-value":"0",loading:e.row.disposeLoadding,"before-change":()=>g.beforeChangeDisposeStatus(e.row)},null,8,["modelValue","onUpdate:modelValue","active-icon","inactive-icon","loading","before-change"])):((0,l.uX)(),(0,l.CE)("span",n,"--"))])),default:(0,l.k6)((()=>[(0,l.bF)(C,{label:"操作",fixed:"right",align:"center",width:"100"},{default:(0,l.k6)((e=>[(0,l.bF)(k,{text:"",type:"primary",size:"small",onClick:t=>g.table_view(e.row)},{default:(0,l.k6)((()=>[(0,l.eW)("查看")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["apiObj","column"])])),_:1}),(0,l.bF)(A,{modelValue:c.drawer,"onUpdate:modelValue":t[3]||(t[3]=e=>c.drawer=e),title:"详情",size:"80%"},{default:(0,l.k6)((()=>[(0,l.bF)(L,{params:c.drawerParams},null,8,["params"])])),_:1},8,["modelValue"])])),_:1})])}var c=a(33240),g=a(48548),b=a(34630),_={name:"listTab",components:{Check:g.Check,Close:g.Close,scEcharts:c.A,DetailView:b["default"]},data(){return{list:{apiObj:this.$API.warn.pfcp.page,column:[{label:"目的IP",prop:"dst_ip"},{label:"目的端口",prop:"dst_port"},{label:"源IP",prop:"src_ip"},{label:"源端口",prop:"src_port"},{label:"攻击阶段",prop:"alter_stage"},{label:"事件时间",prop:"stamptime"},{label:"危险等级",prop:"danger_level"},{label:"处置状态",prop:"dispose_status",width:"100"}]},dangerList:{0:{text:"正常",type:"info"},1:{text:"低",type:"success"},2:{text:"中",type:"primary"},3:{text:"高",type:"danger"}},tagAlterList:{alert0:{text:"侦查阶段",type:"info"},alert1:{text:"入侵暴露面阶段",type:"success"},alert2:{text:"横向移动阶段",type:"primary"},alert3:{text:"攻击核心网阶段",type:"danger"}},disposeIconList:{on:g.Check,off:g.Close},search:{alter_stage:"",danger_level:"",dispose_status:""},option2:{title:{text:"接口异常流量汇总"},grid:{top:"80px"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[{data:[],type:"line"},{data:[],type:"line"}]},matchText:{pfcp_pdr:"恶意篡改PDR规则",pfcp_fdr:"恶意篡改FDR规则",pfcp_delete_session:"恶意构造删除请求",pfcp_n4_smf:"恶意伪造N4接口指令",pfcp_form:"非法格式报文攻击"},drawer:!1,drawerParams:{}}},computed:{showTime(){return e=>this.$moment(e).utc().format("YYYY-MM-DD HH:mm:ss")}},created(){this.initChartData()},methods:{async initChartData(){let e=await this.$API.warn.pfcp.draw.post();this.option2.xAxis.data=e.data.pfcp_type.map((e=>this.matchText[e])),this.option2.series[0].data=e.data.pfcp_alert_total,this.option2.series[1].data=e.data.pfcp_dispose_total},upsearch(){this.$refs.table.upData(this.search)},async beforeChangeDisposeStatus(e){e.disposeLoadding=!0;let t={id:e.id,globel_id:e.globel_id,dispose_status:"0"==e.dispose_status?"1":"0",protocol:e.protocol},a=await this.$API.system.statusChange.put(t);return 200==a.status?(e.disposeLoadding=!1,this.$message.success("处置成功!"),!0):(e.disposeLoadding=!1,this.$message.error("处置失败!"),!1)},table_view(e){this.drawerParams={id:e.id,globel_id:e.globel_id},this.drawer=!0}}},h=a(66262);const m=(0,h.A)(_,[["render",u]]);var f=m}}]);