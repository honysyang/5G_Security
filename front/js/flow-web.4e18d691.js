"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[4906],{24720:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});var l=a(20641),s=a(72644);const r={key:0},o={key:0},i={key:0};function d(e,t,a,d,p,n){const u=(0,l.g2)("el-input"),c=(0,l.g2)("el-form-item"),m=(0,l.g2)("el-date-picker"),h=(0,l.g2)("el-button"),b=(0,l.g2)("el-form"),_=(0,l.g2)("el-header"),g=(0,l.g2)("el-tag"),f=(0,l.g2)("el-switch"),w=(0,l.g2)("el-table-column"),k=(0,l.g2)("scTable"),y=(0,l.g2)("el-main"),v=(0,l.g2)("detail-view"),V=(0,l.g2)("el-drawer"),F=(0,l.g2)("el-container");return(0,l.uX)(),(0,l.Wv)(F,null,{default:(0,l.k6)((()=>[(0,l.bF)(_,{style:{height:"auto"}},{default:(0,l.k6)((()=>[(0,l.bF)(b,{inline:!0,model:p.search,"label-width":"100"},{default:(0,l.k6)((()=>[(0,l.bF)(c,{label:"目的IP"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{modelValue:p.search.dst_ip,"onUpdate:modelValue":t[0]||(t[0]=e=>p.search.dst_ip=e),placeholder:"目的IP",clearable:"",style:{width:"200px"}},null,8,["modelValue"])])),_:1}),(0,l.bF)(c,{label:"源IP"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{modelValue:p.search.src_ip,"onUpdate:modelValue":t[1]||(t[1]=e=>p.search.src_ip=e),placeholder:"源IP",clearable:"",style:{width:"200px"}},null,8,["modelValue"])])),_:1}),(0,l.bF)(c,{label:"目的端口"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{modelValue:p.search.dst_port,"onUpdate:modelValue":t[2]||(t[2]=e=>p.search.dst_port=e),placeholder:"目的端口",clearable:"",style:{width:"200px"}},null,8,["modelValue"])])),_:1}),(0,l.bF)(c,{label:"源端口"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{modelValue:p.search.src_port,"onUpdate:modelValue":t[3]||(t[3]=e=>p.search.src_port=e),placeholder:"源端口",clearable:"",style:{width:"200px"}},null,8,["modelValue"])])),_:1}),(0,l.bF)(c,{label:"发生时间"},{default:(0,l.k6)((()=>[(0,l.bF)(m,{modelValue:p.search.time,"onUpdate:modelValue":t[4]||(t[4]=e=>p.search.time=e),type:"daterange","start-placeholder":"区间开始","end-placeholder":"区间结束",clearable:"",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),(0,l.bF)(c,null,{default:(0,l.k6)((()=>[(0,l.bF)(h,{type:"primary",icon:"el-icon-search",onClick:n.upsearch},null,8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1}),(0,l.bF)(y,{class:"nopadding"},{default:(0,l.k6)((()=>[(0,l.bF)(k,{ref:"table",apiObj:p.list.apiObj,column:p.list.column,params:p.params,"row-key":"id",stripe:""},{alter_stage:(0,l.k6)((e=>[e.row.alter_stage?((0,l.uX)(),(0,l.Wv)(g,{key:1,effect:"dark",type:p.tagAlterList["alert"+e.row.alter_stage].type},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(p.tagAlterList["alert"+e.row.alter_stage].text),1)])),_:2},1032,["type"])):((0,l.uX)(),(0,l.CE)("span",r,"--"))])),danger_level:(0,l.k6)((e=>[-1==e.row.danger_level?((0,l.uX)(),(0,l.CE)("span",o,"--")):((0,l.uX)(),(0,l.Wv)(g,{key:1,effect:"light",type:p.dangerList[e.row.danger_level].type},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(p.dangerList[e.row.danger_level].text),1)])),_:2},1032,["type"]))])),dispose_status:(0,l.k6)((e=>[e.row.dispose_status?((0,l.uX)(),(0,l.Wv)(f,{key:1,modelValue:e.row.dispose_status,"onUpdate:modelValue":t=>e.row.dispose_status=t,"inline-prompt":"","active-icon":p.disposeIconList.on,"inactive-icon":p.disposeIconList.off,"active-value":"1","inactive-value":"0",loading:e.row.disposeLoadding,"before-change":()=>n.beforeChangeDisposeStatus(e.row)},null,8,["modelValue","onUpdate:modelValue","active-icon","inactive-icon","loading","before-change"])):((0,l.uX)(),(0,l.CE)("span",i,"--"))])),stamptime:(0,l.k6)((e=>[(0,l.eW)((0,s.v_)(n.showTime(e.row.stamptime)),1)])),default:(0,l.k6)((()=>[(0,l.bF)(w,{label:"操作",fixed:"right",align:"left",width:"100"},{default:(0,l.k6)((e=>[(0,l.bF)(h,{type:"primary",plain:"",size:"small",onClick:t=>n.table_view(e.row)},{default:(0,l.k6)((()=>[(0,l.eW)("查看")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["apiObj","column","params"])])),_:1}),(0,l.bF)(V,{modelValue:p.drawer,"onUpdate:modelValue":t[5]||(t[5]=e=>p.drawer=e),title:"详情",size:"80%"},{default:(0,l.k6)((()=>[(0,l.bF)(v,{params:p.drawerParams},null,8,["params"])])),_:1},8,["modelValue"])])),_:1})}var p=a(48548),n=a(48529),u={name:"flowDataIndex",components:{Check:p.Check,Close:p.Close,DetailView:n["default"]},data(){return{search:{},dialog:{save:!1,info:!1},list:{apiObj:this.$API.flow.flowWeb.page,column:[{label:"目的IP",prop:"dst_ip"},{label:"源IP",prop:"src_ip"},{label:"目的端口",prop:"dst_port",width:"150"},{label:"源端口",prop:"src_port",width:"150"},{label:"IP类型",prop:"ip_layer",width:"100"},{label:"传输层协议",prop:"protocol_Transport_layer",width:"150"},{label:"应用层协议",prop:"protocol_Application_layer",width:"150"},{label:"发生时间",prop:"stamptime",width:"200"}]},selection:[],params:{src_ip:"",src_port:"",dst_ip:"",dst_port:"",time:[]},tagAlterList:{alert0:{text:"侦查阶段",type:"info"},alert1:{text:"入侵暴露面阶段",type:"success"},alert2:{text:"横向移动阶段",type:"primary"},alert3:{text:"攻击核心网阶段",type:"danger"}},dangerList:{0:{text:"正常",type:"info"},1:{text:"低",type:"success"},2:{text:"中",type:"primary"},3:{text:"高",type:"danger"}},actionList:{0:{text:"通过",type:"success"},1:{text:"告警",type:"danger"},2:{text:"阻断",type:"info"}},disposeIconList:{on:p.Check,off:p.Close},drawer:!1,drawerParams:{}}},computed:{showTime(){return e=>this.$moment(e).utc().format("YYYY-MM-DD HH:mm:ss")}},mounted(){},methods:{async beforeChangeDisposeStatus(e){e.disposeLoadding=!0;let t={id:e.id,dispose_status:"0"==e.dispose_status?"1":"0"},a=await this.$API.flow.flowSignal.disposeStatus.post(t);return 200==a.code?(e.disposeLoadding=!1,this.$message.success("处置成功!"),!0):(e.disposeLoadding=!1,this.$message.error("处置失败!"),!1)},upsearch(){null==this.search.time&&(this.search.time=[]),this.$refs.table.upData(this.search)},table_view(e){this.drawerParams={id:Number(e.id),globel_id:e.globel_id},this.drawer=!0}}},c=a(66262);const m=(0,c.A)(u,[["render",d]]);var h=m}}]);