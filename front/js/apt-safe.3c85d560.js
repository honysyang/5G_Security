"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[4150],{40864:function(e,a,l){l.r(a),l.d(a,{default:function(){return m}});var t=l(20641),s=l(72644);const i=(0,t.Lk)("div",{class:"left-panel"},null,-1),o={class:"right-panel"},r={class:"right-panel-search"};function p(e,a,l,p,d,n){const c=(0,t.g2)("el-option"),u=(0,t.g2)("el-select"),h=(0,t.g2)("el-input"),m=(0,t.g2)("el-button"),b=(0,t.g2)("el-header"),w=(0,t.g2)("el-switch"),f=(0,t.g2)("el-table-column"),g=(0,t.g2)("scTable"),_=(0,t.g2)("el-main"),v=(0,t.g2)("detail-view"),k=(0,t.g2)("el-drawer"),y=(0,t.g2)("el-container");return(0,t.uX)(),(0,t.Wv)(y,null,{default:(0,t.k6)((()=>[(0,t.bF)(b,null,{default:(0,t.k6)((()=>[i,(0,t.Lk)("div",o,[(0,t.Lk)("div",r,[(0,t.bF)(u,{modelValue:d.search.name,"onUpdate:modelValue":a[0]||(a[0]=e=>d.search.name=e),placeholder:"攻击类型",clearable:"",style:{width:"200px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(d.searchName,((e,a)=>((0,t.uX)(),(0,t.Wv)(c,{key:a,value:e,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),(0,t.bF)(u,{modelValue:d.search.protocol,"onUpdate:modelValue":a[1]||(a[1]=e=>d.search.protocol=e),placeholder:"协议",clearable:"",style:{width:"200px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(d.searchProtocol,((e,a)=>((0,t.uX)(),(0,t.Wv)(c,{key:a,value:e,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),(0,t.bF)(h,{modelValue:d.search.ip,"onUpdate:modelValue":a[2]||(a[2]=e=>d.search.ip=e),placeholder:"IP",style:{width:"150px"}},null,8,["modelValue"]),(0,t.bF)(m,{type:"primary",icon:"el-icon-search",onClick:n.upsearch},null,8,["onClick"])])])])),_:1}),(0,t.bF)(_,{class:"nopadding"},{default:(0,t.k6)((()=>[(0,t.bF)(g,{ref:"table",apiObj:d.list.apiObj,column:d.list.column,params:d.params,"row-key":"id",stripe:""},{Timestamp:(0,t.k6)((e=>[(0,t.eW)((0,s.v_)(n.showTime(e.row.Timestamp)),1)])),dispose_status:(0,t.k6)((e=>[(0,t.bF)(w,{modelValue:e.row.dispose_status,"onUpdate:modelValue":a=>e.row.dispose_status=a,"inline-prompt":"","active-icon":d.disposeIconList.on,"inactive-icon":d.disposeIconList.off,"active-value":1,"inactive-value":0,loading:e.row.disposeLoadding,"before-change":()=>n.beforeChangeDisposeStatus(e.row)},null,8,["modelValue","onUpdate:modelValue","active-icon","inactive-icon","loading","before-change"])])),default:(0,t.k6)((()=>[(0,t.bF)(f,{label:"操作",fixed:"right",align:"center",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(m,{text:"",type:"primary",size:"small",onClick:a=>n.table_view(e.row)},{default:(0,t.k6)((()=>[(0,t.eW)("查看")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["apiObj","column","params"])])),_:1}),(0,t.bF)(k,{modelValue:d.drawer,"onUpdate:modelValue":a[3]||(a[3]=e=>d.drawer=e),title:"详情",size:"80%"},{default:(0,t.k6)((()=>[(0,t.bF)(v,{params:d.drawerParams},null,8,["params"])])),_:1},8,["modelValue"])])),_:1})}var d=l(48548),n=l(95393),c={name:"ngap",components:{DetailView:n["default"]},data(){return{params:{},list:{apiObj:this.$API.apt.safe.page,column:[{label:"目的IP",prop:"Dst_ip",width:"150"},{label:"源IP",prop:"Src_ip",width:"150"},{label:"目的端口",prop:"Dst_port",width:"100"},{label:"源端口",prop:"Src_port",width:"100"},{label:"攻击阶段",prop:"alter_stage",width:"150"},{label:"攻击类型",prop:"classtype_v2",width:"150"},{label:"安全事件",prop:"name",width:"150"},{label:"危险等级",prop:"danger_level",width:"100"},{label:"处置状态",prop:"dispose_status",width:"100"},{label:"异常结果",prop:"result_exception",width:"100",hide:!0},{label:"协议类型",prop:"PROTOCOL",width:"120"},{label:"发生时间",prop:"Timestamp",width:"200"},{label:"合并",prop:"total",width:"100"}]},dangerList:{0:{text:"正常",type:"info"},1:{text:"低",type:"success"},2:{text:"中",type:"primary"},3:{text:"高",type:"danger"}},tagAlterList:{0:{text:"侦查阶段",type:"info"},1:{text:"入侵暴露面阶段",type:"success"},2:{text:"横向移动阶段",type:"primary"},3:{text:"攻击核心网阶段",type:"danger"}},disposeIconList:{on:d.Check,off:d.Close},search:{ip:""},matchText:{pfcp_pdr:"恶意篡改PDR规则",pfcp_fdr:"恶意篡改FDR规则",pfcp_delete_session:"恶意构造删除请求",pfcp_n4_smf:"恶意伪造N4接口指令",pfcp_form:"非法格式报文攻击"},searchName:["扫描暴破","web攻击","可疑威胁","漏洞利用","内网攻击","勒索软件","网络攻击","口令安全"],searchProtocol:["TCP","ICMP","UDP","DNS","HTTP","SMB"],drawer:!1,drawerParams:{}}},computed:{showTime(){return e=>this.$moment(e).utc().format("YYYY-MM-DD HH:mm:ss")}},created(){},methods:{upsearch(){this.$refs.table.upData(this.search)},async beforeChangeDisposeStatus(e){e.disposeLoadding=!0;let a={id:e.id,dispose_status:"0"==e.dispose_status?"1":"0"},l=await this.$API.apt.statusChange.put(a);return 200==l.status?(e.disposeLoadding=!1,this.$message.success("处置成功!"),!0):(e.disposeLoadding=!1,this.$message.error("处置失败!"),!1)},table_view(e){this.drawerParams={sid:e.sid,type:"safe"},this.drawer=!0}}},u=l(66262);const h=(0,u.A)(c,[["render",p]]);var m=h}}]);