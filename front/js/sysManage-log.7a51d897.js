"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[3297],{31899:function(e,l,a){a.r(l),a.d(l,{default:function(){return u}});var t=a(20641),o=a(72644);const r={class:"left-panel"},s={class:"right-panel"},p={class:"right-panel-search"};function n(e,l,a,n,i,c){const d=(0,t.g2)("el-button"),u=(0,t.g2)("el-date-picker"),_=(0,t.g2)("el-option"),T=(0,t.g2)("el-select"),m=(0,t.g2)("el-header"),b=(0,t.g2)("scTable"),E=(0,t.g2)("el-main"),h=(0,t.g2)("el-container");return(0,t.uX)(),(0,t.Wv)(h,null,{default:(0,t.k6)((()=>[(0,t.bF)(m,null,{default:(0,t.k6)((()=>[(0,t.Lk)("div",r,[(0,t.bF)(d,{type:"primary",onClick:c.downLoadLog},{default:(0,t.k6)((()=>[(0,t.eW)("下载日志")])),_:1},8,["onClick"])]),(0,t.Lk)("div",s,[(0,t.Lk)("div",p,[(0,t.bF)(u,{modelValue:i.search.time,"onUpdate:modelValue":l[0]||(l[0]=e=>i.search.time=e),type:"daterange","start-placeholder":"区间开始","end-placeholder":"区间结束",clearable:"",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"]),(0,t.bF)(T,{modelValue:i.search.log_type,"onUpdate:modelValue":l[1]||(l[1]=e=>i.search.log_type=e),placeholder:"类型",clearable:"",style:{width:"200px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(i.matchSearchLogType,(e=>((0,t.uX)(),(0,t.Wv)(_,{key:e.key,value:e.key,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),(0,t.bF)(d,{type:"primary",icon:"el-icon-search",onClick:c.upsearch},null,8,["onClick"])])])])),_:1}),(0,t.bF)(E,{class:"nopadding"},{default:(0,t.k6)((()=>[(0,t.bF)(b,{ref:"table",apiObj:i.list.apiObj,column:i.list.column,params:i.params,"row-key":"id",stripe:""},{event_time:(0,t.k6)((e=>[(0,t.eW)((0,o.v_)(c.showTime(e.row.event_time)),1)])),ip_address:(0,t.k6)((e=>[(0,t.eW)((0,o.v_)(null==e.row.ip_address?"系统内部":e.row.ip_address),1)])),log_type:(0,t.k6)((e=>[(0,t.eW)((0,o.v_)(i.matchLogType[e.row.log_type]),1)])),_:1},8,["apiObj","column","params"])])),_:1})])),_:1})}var i={name:"ngap",components:{},data(){return{params:{user_id:this.$TOOL.data.get("USER_INFO").user_id},list:{apiObj:this.$API.sysManage.log,column:[{label:"行为",prop:"log_message"},{label:"类型",prop:"log_type"},{label:"IP",prop:"ip_address"},{label:"主体",prop:"user_name"},{label:"模块",prop:"module"},{label:"异常情况",prop:"severity"},{label:"时间",prop:"event_time"}]},matchLogType:{1:"LOGIN",2:"LOGOUT",3:"SYSTEM_START",4:"SYSTEM_UPGRADE",5:"CONFIG_CHANGE",6:"ENTITY_CREATE",7:"ENTITY_DELETE",8:"ENTITY_UPDATE",9:"AUDIT_LOG_SAVE",10:"AUDIT_LOG_DELETE",11:"SYSTEM_WARNING"},matchSearchLogType:[{key:1,label:"LOGIN"},{key:2,label:"LOGOUT"},{key:3,label:"SYSTEM_START"},{key:4,label:"SYSTEM_UPGRADE"},{key:5,label:"CONFIG_CHANGE"},{key:6,label:"ENTITY_CREATE"},{key:7,label:"ENTITY_DELETE"},{key:8,label:"ENTITY_UPDATE"},{key:9,label:"AUDIT_LOG_SAVE"},{key:10,label:"AUDIT_LOG_DELETE"},{key:11,label:"SYSTEM_WARNING"}],search:{time:[],log_type:""}}},computed:{showTime(){return e=>this.$moment(e).format("YYYY-MM-DD HH:mm:ss")}},created(){var e=this.$TOOL.data.get("USER_INFO");console.log(e)},methods:{upsearch(){this.$refs.table.upData(this.search)},async downLoadLog(){let e=`${this.$API.system.log.down.url}`;window.open(e)}}},c=a(66262);const d=(0,c.A)(i,[["render",n]]);var u=d}}]);