"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[2624],{19456:function(e,n,t){t.r(n),t.d(n,{default:function(){return f}});var a=t(20641),s=t(72644),l=t(9322);const i={class:"base-content"},o={class:"custom-tree-node"},r={class:"label"},d={class:"do"};function u(e,n,t,u,c,m){const h=(0,a.g2)("el-input"),g=(0,a.g2)("el-header"),p=(0,a.g2)("el-button"),f=(0,a.g2)("el-tree"),k=(0,a.g2)("el-main"),v=(0,a.g2)("el-footer"),b=(0,a.g2)("el-container"),$=(0,a.g2)("el-aside"),F=(0,a.g2)("save"),y=(0,a.gN)("loading");return(0,a.uX)(),(0,a.CE)("div",i,[(0,a.bF)(b,null,{default:(0,a.k6)((()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)($,{width:"300px"},{default:(0,a.k6)((()=>[(0,a.bF)(b,null,{default:(0,a.k6)((()=>[(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(h,{placeholder:"输入关键字进行过滤",modelValue:c.menuFilterText,"onUpdate:modelValue":n[0]||(n[0]=e=>c.menuFilterText=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.bF)(k,{class:"nopadding"},{default:(0,a.k6)((()=>[(0,a.bF)(f,{ref:"menu",class:"menu","node-key":"id",data:c.menuList,props:c.menuProps,draggable:!1,"highlight-current":"","expand-on-click-node":!1,"check-strictly":"","show-checkbox":"","filter-node-method":m.menuFilterNode,onNodeClick:m.menuClick,onNodeDrop:m.nodeDrop},{default:(0,a.k6)((({node:e,data:n})=>[(0,a.Lk)("span",o,[(0,a.Lk)("span",r,(0,s.v_)(e.label),1),(0,a.Lk)("span",d,[(0,a.bF)(p,{icon:"el-icon-plus",size:"small",onClick:(0,l.D$)((t=>m.add(e,n)),["stop"])},null,8,["onClick"])])])])),_:1},8,["data","props","filter-node-method","onNodeClick","onNodeDrop"])])),_:1}),(0,a.bF)(v,{style:{height:"51px"}},{default:(0,a.k6)((()=>[(0,a.bF)(p,{type:"primary",size:"small",icon:"el-icon-plus",onClick:n[1]||(n[1]=e=>m.add())}),(0,a.bF)(p,{type:"danger",size:"small",plain:"",icon:"el-icon-delete",onClick:m.delMenu},null,8,["onClick"])])),_:1})])),_:1})])),_:1})),[[y,c.menuloading]]),(0,a.bF)(b,null,{default:(0,a.k6)((()=>[(0,a.bF)(k,{class:"nopadding",style:{padding:"20px"},ref:"main"},{default:(0,a.k6)((()=>[(0,a.bF)(F,{ref:"save",menu:c.menuList},null,8,["menu"])])),_:1},512)])),_:1})])),_:1})])}t(28743);var c=t(23534);let m=1;var h={name:"settingMenu",components:{save:c["default"]},data(){return{menuloading:!1,menuList:[],menuProps:{label:e=>e.title},menuFilterText:""}},watch:{menuFilterText(e){this.$refs.menu.filter(e)}},mounted(){this.getMenu()},methods:{async getMenu(){this.menuloading=!0;var e=await this.$API.sysManage.menu.list.post();let n=this.arrayToTree(e.data);console.log(n),this.menuloading=!1,this.menuList=n},arrayToTree(e,n=0){let t=[];for(let a=0;a<e.length;a++)if(e[a].parentId===n){const n=e[a];n.children=this.arrayToTree(e,n.id),t.push(n)}return t},menuClick(e,n){console.log(e,n);var t=1==n.level?0:n.parent.data.id;this.$refs.save.setData(e,t),this.$refs.main.$el.scrollTop=0},menuFilterNode(e,n){if(!e)return!0;var t=n.title;return-1!==t.indexOf(e)},nodeDrop(e,n,t){this.$refs.save.setData({}),this.$message(`拖拽对象：${e.data.title}, 释放对象：${n.data.title}, 释放对象的位置：${t}`)},async add(e,n){var t="未命名"+m++,a={parentId:n?n.id:0,name:"",path:"",component:"",title:t,icon:"",status:"INACTIVE"};this.menuloading=!0,console.log(a);var s=await this.$API.sysManage.menu.addMenu.post(a);this.menuloading=!1,a.id=s.data,this.$refs.menu.append(a,e),this.$refs.menu.setCurrentKey(a.id);var l=e?e.data.id:"";this.$refs.save.setData(a,l)},async delMenu(){var e=this.$refs.menu.getCheckedNodes();if(0==e.length)return this.$message.warning("请选择需要删除的项"),!1;var n=await this.$confirm("确认删除已选择的菜单吗？","提示",{type:"warning",confirmButtonText:"删除",confirmButtonClass:"el-button--danger"}).catch((()=>{}));if("confirm"!=n)return!1;this.menuloading=!0;var t={menu_ids:e.map((e=>e.id)).join(",")};console.log(t);var a=await this.$API.sysManage.menu.delMenu.delete(t);this.menuloading=!1,200==a.code?e.forEach((e=>{var n=this.$refs.menu.getNode(e);n.isCurrent&&this.$refs.save.setData({}),this.$refs.menu.remove(e)})):this.$message.warning(a.message)}}},g=t(66262);const p=(0,g.A)(h,[["render",u],["__scopeId","data-v-75e91155"]]);var f=p}}]);