"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[59],{2026:function(e,s,a){a.r(s),a.d(s,{default:function(){return g}});var t=a(20641),l=a(72644);const i={class:"left-panel"},o={class:"right-panel"},r={class:"right-panel-search"};function n(e,s,a,n,d,c){const u=(0,t.g2)("el-button"),p=(0,t.g2)("el-upload"),h=(0,t.g2)("el-input"),m=(0,t.g2)("el-option"),g=(0,t.g2)("el-select"),b=(0,t.g2)("el-header"),f=(0,t.g2)("el-table-column"),w=(0,t.g2)("el-switch"),_=(0,t.g2)("el-popconfirm"),k=(0,t.g2)("el-button-group"),y=(0,t.g2)("scTable"),v=(0,t.g2)("el-main"),$=(0,t.g2)("detail-view"),F=(0,t.g2)("el-drawer"),C=(0,t.g2)("el-container"),I=(0,t.g2)("save-dialog");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.bF)(C,null,{default:(0,t.k6)((()=>[(0,t.bF)(b,null,{default:(0,t.k6)((()=>[(0,t.Lk)("div",i,[(0,t.bF)(u,{type:"primary",icon:"el-icon-plus",onClick:c.add},null,8,["onClick"]),(0,t.bF)(u,{type:"danger",plain:"",icon:"el-icon-delete",disabled:0==d.selection.length,onClick:c.batch_del},null,8,["disabled","onClick"]),(0,t.bF)(p,{"file-list":e.fileList,"onUpdate:fileList":s[0]||(s[0]=s=>e.fileList=s),action:"https://192.168.181.60:7000/ais_multidimensional_control/policy/import",limit:1,"show-file-list":!1,style:{"margin-left":"10px"},"on-success":c.uploadSuccess,data:d.fileData},{default:(0,t.k6)((()=>[(0,t.bF)(u,{type:"primary",plain:"",icon:"sc-icon-upload"},{default:(0,t.k6)((()=>[(0,t.eW)("导入")])),_:1})])),_:1},8,["file-list","on-success","data"])]),(0,t.Lk)("div",o,[(0,t.Lk)("div",r,[(0,t.bF)(h,{modelValue:d.search.name_keyword,"onUpdate:modelValue":s[1]||(s[1]=e=>d.search.name_keyword=e),placeholder:"策略名称",clearable:""},null,8,["modelValue"]),(0,t.bF)(g,{modelValue:d.search.status,"onUpdate:modelValue":s[2]||(s[2]=e=>d.search.status=e),placeholder:"状态",clearable:"",style:{width:"200px"}},{default:(0,t.k6)((()=>[(0,t.bF)(m,{label:"禁用",value:"0"}),(0,t.bF)(m,{label:"启用",value:"1"})])),_:1},8,["modelValue"]),(0,t.bF)(u,{type:"primary",icon:"el-icon-search",onClick:c.upsearch},null,8,["onClick"])])])])),_:1}),(0,t.bF)(v,{class:"nopadding"},{default:(0,t.k6)((()=>[(0,t.bF)(y,{ref:"table",apiObj:d.list.apiObj,column:d.list.column,params:d.params,"row-key":"id",stripe:"",onSelectionChange:c.selectionChange},{Timestamp:(0,t.k6)((e=>[(0,t.eW)((0,l.v_)(c.showTime(e.row.Timestamp)),1)])),status:(0,t.k6)((e=>[(0,t.bF)(w,{modelValue:e.row.status,"onUpdate:modelValue":s=>e.row.status=s,"inline-prompt":"","active-icon":d.disposeIconList.on,"inactive-icon":d.disposeIconList.off,"active-value":"1","inactive-value":"0",loading:e.row.disposeLoadding,"before-change":()=>c.beforeChangeDisposeStatus(e.row)},null,8,["modelValue","onUpdate:modelValue","active-icon","inactive-icon","loading","before-change"])])),default:(0,t.k6)((()=>[(0,t.bF)(f,{type:"selection",width:"50"}),(0,t.bF)(f,{label:"操作",fixed:"right",align:"center",width:"220"},{default:(0,t.k6)((e=>[(0,t.bF)(k,null,{default:(0,t.k6)((()=>[(0,t.bF)(u,{text:"",type:"primary",size:"small",onClick:s=>c.table_view(e.row)},{default:(0,t.k6)((()=>[(0,t.eW)("查看")])),_:2},1032,["onClick"]),(0,t.bF)(u,{text:"",type:"primary",size:"small",onClick:s=>c.table_edit(e.row,e.$index)},{default:(0,t.k6)((()=>[(0,t.eW)("编辑")])),_:2},1032,["onClick"]),(0,t.bF)(_,{title:"确定删除吗？",onConfirm:s=>c.table_del(e.row,e.$index)},{reference:(0,t.k6)((()=>[(0,t.bF)(u,{text:"",type:"primary",size:"small"},{default:(0,t.k6)((()=>[(0,t.eW)("删除")])),_:1})])),_:2},1032,["onConfirm"]),(0,t.bF)(u,{text:"",type:"primary",size:"small",onClick:s=>c.download(e.row)},{default:(0,t.k6)((()=>[(0,t.eW)("导出")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["apiObj","column","params","onSelectionChange"])])),_:1}),(0,t.bF)(F,{modelValue:d.drawer,"onUpdate:modelValue":s[3]||(s[3]=e=>d.drawer=e),title:"详情",size:"80%"},{default:(0,t.k6)((()=>[(0,t.bF)($,{params:d.drawerParams},null,8,["params"])])),_:1},8,["modelValue"])])),_:1}),d.dialog.save?((0,t.uX)(),(0,t.Wv)(I,{key:0,ref:"saveDialog",onSuccess:c.handleSaveSuccess,onClosed:s[4]||(s[4]=e=>d.dialog.save=!1)},null,8,["onSuccess"])):(0,t.Q3)("",!0)],64)}var d=a(48548),c=a(26759),u=a(52736),p={name:"ngap",components:{DetailView:c["default"],saveDialog:u["default"]},data(){return{params:{status:""},selection:[],list:{apiObj:this.$API.strategy.unit.page,column:[{label:"策略名称",prop:"name",width:"150"},{label:"目的IP",prop:"dst_ip",width:"150",showOverflowTooltip:!0},{label:"源IP",prop:"src_ip",width:"150",showOverflowTooltip:!0},{label:"源5G-GUTI",prop:"src_guti"},{label:"源IMSI",prop:"src_imsi"},{label:"状态",prop:"status",width:"100"},{label:"标签",prop:"labels",width:"100",showOverflowTooltip:!0},{label:"协议类型",prop:"protocols",width:"120"}]},disposeIconList:{on:d.Check,off:d.Close},search:{name_keyword:"",status:"",label:""},drawer:!1,drawerParams:{},dialog:{save:!1},fileData:{},userId:""}},computed:{showTime(){return e=>this.$moment(e).utc().format("YYYY-MM-DD HH:mm:ss")}},created(){var e=this.$TOOL.data.get("USER_INFO");this.userId=e.user_id,this.fileData={user_id:e.user_id}},methods:{upsearch(){this.$refs.table.upData(this.search)},async beforeChangeDisposeStatus(e){e.disposeLoadding=!0;let s={policy_id:e.id,status:"0"==e.status?"1":"0"},a=await this.$API.strategy.unit.status.put(s);return 200==a.status?(e.disposeLoadding=!1,this.$message.success("处置成功!"),!0):(e.disposeLoadding=!1,this.$message.error("处置失败!"),!1)},table_view(e){this.drawerParams={id:e.id},this.drawer=!0},add(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open()}))},handleSaveSuccess(e,s){("add"==s||"edit"==s)&&this.$refs.table.refresh()},selectionChange(e){this.selection=e},async batch_del(){this.$confirm(`确定删除选中的 ${this.selection.length} 项吗？`,"提示",{type:"warning"}).then((()=>{var e=this.$TOOL.data.get("USER_INFO");let s={policy_id:this.selection.map((e=>e.id)).join(","),user_id:e.user_id,status:"-1"};console.log(s),this.$API.strategy.unit.del.put(s).then((e=>{200==e.status?(this.$refs.table.refresh(),this.$message.success("操作成功")):this.$alert(e.message,"提示",{type:"error"})})),this.$refs.table.refresh(),this.$message.success("操作成功")})).catch((()=>{}))},async table_del(e){let s={policy_id:`${e.id}`,status:"-1"};var a=this.$TOOL.data.get("USER_INFO");s.user_id=a.user_id;let t=await this.$API.strategy.unit.del.put(s);200==t.status?(this.$refs.table.refresh(),this.$message.success("操作成功")):this.$alert(t.message,"提示",{type:"error"})},table_edit(e){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open("edit").setData(e)}))},async download(e){let s=`${this.$API.strategy.unit.down.url}?policy_id=${e.id}&&user_id=${this.userId}`;window.open(s)},uploadSuccess(e){console.log(e),200==e.status&&e.success?(this.$message.success("上传完成"),this.$refs.table.upData(this.search)):this.$message.error(e.message)}}},h=a(66262);const m=(0,h.A)(p,[["render",n]]);var g=m}}]);